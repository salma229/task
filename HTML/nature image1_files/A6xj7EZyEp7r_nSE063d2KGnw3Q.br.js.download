function changeHrefOnClick(n){var t=n.target||n.srcElement,i=n.currentTarget,r,u;if(!t||t.nodeName.toLocaleLowerCase()!="a")if(i&&i.nodeName.toLocaleLowerCase()=="a")t=i;else return;t&&t.getAttribute("href")&&(r=new URL(t.getAttribute("href"),window.location.href),u=updateURL(r),t.setAttribute("href",u.href))}function updateURL(n){var o=new URL(window.location.href);if(!isBingSource(o)||!isSameOrigin(n)||!isWhitelistUrl(n))return n;var t=getUrlParams(n),i=getUrlParams(o),u=null,f=null,r=null;hasStorage&&(r=fetchItem(marketName),u=fetchItem(languageName),f=fetchItem(regionName));i&&(i.get("setmkt")?r=i.get("setmkt"):i.get("mkt")?r=i.get("mkt"):i.get("market")&&(r=i.get("market")),i.get("setlang")&&(u=i.get("setlang")),i.get("cc")&&(f=i.get("cc")));var e=!1,s=!1,h=!1;return t&&(t.get("setmkt")?(r=t.get("setmkt"),e=!0):t.get("mkt")?(r=t.get("mkt"),e=!0):t.get("market")&&(r=t.get("market"),e=!0),t.get("setlang")&&(u=t.get("setlang"),s=!0),t.get("cc")&&(f=t.get("cc"),h=!0)),r&&(cacheItem(marketName,r),e||(n=addUrlParam(n,"setmkt",String(r)))),u&&(cacheItem(languageName,u),s||(n=addUrlParam(n,"setlang",String(u)))),f&&(cacheItem(regionName,f),h||(n=addUrlParam(n,"cc",String(f)))),n}function addFieldOnSubmit(){var u=new URL(window.location.href);if(isBingSource(u)){var n=getUrlParams(u),i=null,r=null,t=null;hasStorage&&(t=fetchItem(marketName),i=fetchItem(languageName),r=fetchItem(regionName));n&&(n.get("setmkt")?t=n.get("setmkt"):n.get("mkt")?t=n.get("mkt"):n.get("market")&&(t=n.get("market")),n.get("setlang")&&(i=n.get("setlang")),n.get("cc")&&(r=n.get("cc")));t&&(hasStorage&&cacheItem(marketName,t),addHiddenField(searchBoxForm,"setmkt",t));i&&(hasStorage&&cacheItem(languageName,i),addHiddenField(searchBoxForm,"setlang",i));r&&(hasStorage&&cacheItem(regionName,r),addHiddenField(searchBoxForm,"cc",r))}}function cacheItem(n,t){sessionStorage.getItem(sessionStoragePrefix+n)&&sessionStorage.removeItem(sessionStoragePrefix+n);sessionStorage.setItem(sessionStoragePrefix+n,t)}function fetchItem(n){return sessionStorage.getItem(sessionStoragePrefix+n)}function checkSessionStorage(){try{sessionStorage.setItem(sessionStoragePrefix,sessionStoragePrefix);sessionStorage.removeItem(sessionStoragePrefix);hasStorage=!0}catch(n){hasStorage=!1}}function isBingSource(n){var t,i,r;return((t=n===null||n===void 0?void 0:n.href)===null||t===void 0?void 0:t.indexOf("staging-bing-int.com"))>=0||((i=n===null||n===void 0?void 0:n.href)===null||i===void 0?void 0:i.indexOf("bing-exp.com"))>=0||((r=n===null||n===void 0?void 0:n.href)===null||r===void 0?void 0:r.indexOf("bing.com"))>=0}function isSameOrigin(n){var t,i;return((t=n===null||n===void 0?void 0:n.href)===null||t===void 0?void 0:t.indexOf(window.location.host))>=0||((i=n===null||n===void 0?void 0:n.href)===null||i===void 0?void 0:i.indexOf("/"))==0}function getUrlParams(n){if(n&&n.searchParams&&n.searchParams.get){var t=new URLSearchParams;return n.searchParams.forEach(function(n,i){t.append(i.toLowerCase(),n)}),t}return null}function addUrlParam(n,t,i){var u=new URL(n),r=u.href;return r=r.indexOf("?")==-1?r+"?"+t+"="+i:r.lastIndexOf("&")!=r.length-1?r+"&"+t+"="+i:r+t+"="+i,u.href=r,u}function addHiddenField(n,t,i){var f,e,u,r;if(n){for(f=n.getElementsByTagName("input"),e=!1,u=0;u<f.length;u++)f[u].name===t&&(e=!0);e||(r=document.createElement("input"),r.setAttribute("id","sa_"+t),r.setAttribute("name",t),r.setAttribute("value",i),r.setAttribute("type","hidden"),n.appendChild(r))}}function isWhitelistUrl(n){var t=n===null||n===void 0?void 0:n.pathname;return t&&pathWhitelist.indexOf(t.toLowerCase())!=-1}var searchBoxFormId="sb_form",sessionStoragePrefix="bingtabparam#",marketName="market",languageName="language",regionName="region",hasStorage=!1,aTag,originUrl,searchBoxForm,pathWhitelist;(function(){var i,t,n,r;for(checkSessionStorage(),i=XMLHttpRequest.prototype.open,i&&(XMLHttpRequest.prototype.open=function(n,t){for(var u=[],r=2;r<arguments.length;r++)u[r-2]=arguments[r];t=updateURL(t);i.apply(this,arguments)},Log.Log("LanRegionUtil","XHRInit","Success",!1)),searchBoxForm=_ge(searchBoxFormId),searchBoxForm&&(sj_be(searchBoxForm,"submit",addFieldOnSubmit),Log.Log("LanRegionUtil","SearchBoxFormInit","Success",!1)),t=document.getElementsByTagName("a"),n=0;n<t.length;n++)t[n]&&t[n].href&&(r=new URL(t[n].href,window.location.href),isSameOrigin(r)&&!r.hash&&t[n].addEventListener("click",changeHrefOnClick));Log.Log("LanRegionUtil","HrefInit","Success",!1)})();pathWhitelist=["/","/academic/partnerapi","/academic/partnerapi/search","/academic/search","/account","/account/general","/as/suggestions","/bq/search","/business","/business/search","/cricketdetails","/dict/partnerapi","/dict/partnerapi/search","/dict/search","/entertainment","/entertainment/details","/entities/search","/entityexplore","/fun","/globallife","/globallife/search","/hp","/images/create","/images/feed","/images/hosted","/images/hosted/search","/images/sbi","/images/search","/images/xml","/jobs","/maps","/maps/ee","/maps/infoboxoverlaybfpr","/maps/localoverlaybfpr","/maps/overlay","/maps/overlaybfpr","/moreads","/news/search","/opalweb","/profile/history","/profile/interests","/profile/notifications/settings","/rebates","/rebates/deals","/saves","/school","/school/search","/search","/shop","/shopping/search","/singleanswer/search","/travel","/travelguide","/videos/api/custom/details","/videos/browsing","/videos/browsing/onecolumn/shortvideos","/videos/riverview/relatedvideo","/videos/search","/weather/","/work","/work/search"]