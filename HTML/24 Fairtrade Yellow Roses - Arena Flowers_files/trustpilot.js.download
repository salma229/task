"use strict";/* eslint-disable no-console */ /**
 * Reference: https://support.trustpilot.com/hc/en-us/articles/201748946#trustscore-star-rating-1
 * */const starsInfo={0:{url:"/img/shared/trustpilot/stars-0.svg",label:""},1:{url:"/img/shared/trustpilot/stars-1.svg",label:"Bad"},1.5:{url:"/img/shared/trustpilot/stars-1.5.svg",label:"Bad"},2:{url:"/img/shared/trustpilot/stars-2.svg",label:"Poor"},2.5:{url:"/img/shared/trustpilot/stars-2.5.svg",label:"Poor"},3:{url:"/img/shared/trustpilot/stars-3.svg",label:"Average"},3.5:{url:"/img/shared/trustpilot/stars-3.5.svg",label:"Average"},4:{url:"/img/shared/trustpilot/stars-4.svg",label:"Great"},4.5:{url:"/img/shared/trustpilot/stars-4.5.svg",label:"Excellent"},5:{url:"/img/shared/trustpilot/stars-5.svg",label:"Excellent"}},baseUrl="https://api.trustpilot.com/v1/";/*!
 * Get the amount of time from now for a date
 * (c) 2021 Chris Ferdinandi, MIT License, https://gomakethings.com
 * @param  {String|Date} time The date to get the time from now for
 * @return {Object}           The time from now data
 */function timeFromNow(a){// Get timestamps
const b=new Date(a).getTime();if(!b)return!1;const c=new Date().getTime();// Calculate difference
let d=b/1e3-c/1e3;// Setup return object
const e={};// Check if time is in the past, present, or future
// Return time from now data
return e.when="now",0<d?e.when="future":-1>d&&(e.when="past"),d=Math.abs(d),1<d/31536000?(e.unitOfTime="years",e.time=Math.floor(d/31536000)):1<d/3888000?(e.unitOfTime="months",e.time=Math.floor(d/3888000)):1<d/86400?(e.unitOfTime="days",e.time=Math.floor(d/86400)):1<d/3600?(e.unitOfTime="hours",e.time=Math.floor(d/3600)):1<d/60?(e.unitOfTime="minutes",e.time=Math.floor(d/60)):(e.unitOfTime="seconds",e.time=Math.floor(d)),e}function getStar(a){return Math.round(2*a)/2}function scrollSlider(a,b){const c=a.querySelector(".slider-review"),d=a.querySelector(".trustpilot-slider-reviews");"right"===b?d.scrollLeft+=c.offsetWidth:d.scrollLeft-=c.offsetWidth}function hideLoading(a,b){const c=a.querySelector(b),d=a.querySelector(".trustpilot-loading");d.style.display="none",c.style.display="flex"}function hideOnError(a){// eslint-disable-next-line no-param-reassign
a.style.display="none"}function fetchAPI(a,b,c){const d=new XMLHttpRequest;d.open("GET",a),d.setRequestHeader("apiKey",b),d.send(),d.addEventListener("loadend",()=>200===d.status?void c(JSON.parse(d.responseText)):void c(!1))}function fetchProductReviews(a,b,c,d){if(!a||!b||!c)return void d(!1);const e="".concat(baseUrl,"product-reviews/business-units/").concat(c,"?stars=4,5&sku=").concat(a),f="".concat(baseUrl,"product-reviews/business-units/").concat(c,"/reviews?stars=4,5&sku=").concat(a);fetchAPI(e,b,a=>a?void fetchAPI(f,b,b=>b?void d(Object.assign(a,b)):void d(!1)):void d(!1))}function fetchBusinessReview(a,b,c){if(!a||!b)return void c(!1);const d="".concat(baseUrl,"business-units/").concat(b);fetchAPI(d,a,c)}function fetchLatestReviews(a,b,c,d,e){if(!a)return void e(!1);const f="".concat(baseUrl,"/business-units/").concat(b,"/reviews?perPage=").concat(c,"&stars=").concat(d);fetchAPI(f,a,e)}function renderProductReview(a){const{stars:b,consumer:{displayName:f},createdAt:c,content:d,attachments:e}=a,g=timeFromNow(c),h=[];Array.isArray(e)&&0<e.length&&h.push(e.map(a=>{let{processedFiles:b}=a;return Array.isArray(b)?"<li><a href=\"".concat(b[0].url,"\" target=\"_blank\">\n        <img src=\"").concat(b[1].url,"\" alt=\"Photo by ").concat(f,"\"/></a></li>"):""}));const i="<div class=\"product-review\"><div class=\"product-review-header\"><div><div>\n  <img src='".concat(starsInfo[b].url,"' widht='120' heigth=\"22\" alt='Review by ").concat(f,"'></div>\n  <p>by ").concat(f,"</p></div><div>").concat(g.time," ").concat(g.unitOfTime," ago</div></div>\n  <div class=\"product-review-body\"><p>").concat(d,"</p>\n  ").concat(0<h.length?"<div><div>Customer photo(s)</div><ul>".concat(h.join(),"</ul></div>"):"","\n  </div></div>");return i}function renderGridReview(a){const{id:b,stars:c,consumer:{displayName:g},createdAt:d,title:e,text:f}=a,h=timeFromNow(d),i="<div class=\"grid-review\"><div class=\"grid-review-header\"><div><div>\n  <img src='".concat(starsInfo[c].url,"' widht='107' heigth=\"20\" alt='Review by ").concat(g,"'>\n  </div><div>").concat(g,"</div></div><div>").concat(h.time," ").concat(h.unitOfTime," ago</div></div><div class=\"grid-review-body\">\n  <a href=\"https://uk.trustpilot.com/reviews/").concat(b,"\" target=\"_blank\" rel=\"noopener noreferrer\"><strong>").concat(e,"</strong></a><p>").concat(f,"</p></div></div>");return i}function renderBusinessSliderReview(a){const{id:b,stars:c,consumer:{displayName:g},createdAt:d,title:e,text:f}=a,h=timeFromNow(d),i="<div class=\"slider-review\"><div class=\"slider-review-header\"><div><div>\n  <img src='".concat(starsInfo[c].url,"' widht='106' heigth=\"20\" alt='Review by ").concat(g,"'>\n  </div><div>").concat(g,"</div></div><div>").concat(h.time," ").concat(h.unitOfTime," ago</div></div><div class=\"slider-review-body\">\n  <a href=\"https://uk.trustpilot.com/reviews/").concat(b,"\" target=\"_blank\" rel=\"noopener noreferrer\"><strong>").concat(e,"</strong>\n  </a><p>").concat(truncateByWords(f,25),"</p></div></div>");return i}function renderProductSliderReview(a){const{stars:b,consumer:{displayName:e},createdAt:c,content:d}=a,f=timeFromNow(c),g="<div class=\"slider-review\"><div class='review'>\n      <img src='".concat(starsInfo[b].url,"' widht='106' heigth=\"20\" alt='Review by ").concat(e,"'>\n      <div class=\"slider-review-body\"><p>").concat(truncateByWords(d,25),"</p></div>\n      <div class=\"author\">by ").concat(e,"<br />").concat(f.time," ").concat(f.unitOfTime," ago</div></div></div>");return g}function trustWidget(a,b,c,d){const e=a.querySelector(".stars-average-img"),f=a.querySelector(".stars-average"),g=a.querySelector(".number-of-reviews");c&&f&&(f.textContent=c),d&&g&&(g.innerHTML="".concat(d," Reviews")),b&&e&&(e.setAttribute("src",starsInfo[getStar(b)].url),e.setAttribute("alt","".concat(b," out of five star rating on Trustpilot")))}function productWidget(a){let b=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1];const c=a.querySelector(".trustpilot-product-reviews"),d=a.getAttribute("data-key"),e=a.getAttribute("data-id"),f=a.getAttribute("data-sku");fetchProductReviews(f,d,e,d=>d?void(trustWidget(a,d.starsAverage,d.starsAverage,d.numberOfReviews.total),b&&Array.isArray(d.productReviews)&&d.productReviews.forEach(a=>{c.innerHTML+=renderProductReview(a)}),hideLoading(a,".trustpilot-product")):void hideOnError(a))}function miniWidget(a){const b=a.getAttribute("data-key"),c=a.getAttribute("data-id");fetchBusinessReview(b,c,b=>b?void(trustWidget(a,b.score.stars,b.score.trustScore,b.numberOfReviews.total),hideLoading(a,".trustpilot-mini")):void hideOnError(a))}function gridWidget(a){const b=a.querySelector(".trustpilot-grid-reviews"),c=a.querySelector(".stars-label"),d=a.getAttribute("data-key"),e=a.getAttribute("data-id");fetchBusinessReview(d,e,f=>f?void(trustWidget(a,f.score.trustScore,f.score.trustScore,f.numberOfReviews.total),c.textContent=starsInfo[getStar(f.score.trustScore)].label,fetchLatestReviews(d,e,30,"4,5",c=>c?void(Array.isArray(c.reviews)&&c.reviews.forEach(a=>{b.innerHTML+=renderGridReview(a)}),hideLoading(a,".trustpilot-grid")):void hideOnError(a))):void hideOnError(a))}function sliderBusinessWidget(a){const b=a.querySelector(".trustpilot-slider-reviews"),c=a.getAttribute("data-key"),d=a.getAttribute("data-id"),e=a.querySelector("#trust-arrow-left"),f=a.querySelector("#trust-arrow-right");fetchBusinessReview(c,d,e=>e?void(trustWidget(a,null,e.score.trustScore,e.numberOfReviews.total),fetchLatestReviews(c,d,20,5,c=>c?void(Array.isArray(c.reviews)&&c.reviews.forEach(a=>{b.innerHTML+=renderBusinessSliderReview(a)}),hideLoading(a,".trustpilot-slider")):void hideOnError(a))):void hideOnError(a)),e.addEventListener("click",()=>{scrollSlider(a,"left")}),f.addEventListener("click",()=>{scrollSlider(a,"right")})}function microWidget(a){const b=a.querySelector(".stars-label"),c=a.getAttribute("data-key"),d=a.getAttribute("data-id");fetchBusinessReview(c,d,c=>c?void(trustWidget(a,c.score.stars,c.score.trustScore,c.numberOfReviews.total),b.textContent=starsInfo[getStar(c.score.trustScore)].label,hideLoading(a,".trustpilot-micro")):void hideOnError(a))}function sliderProductWidget(a){const b=a.querySelector(".trustpilot-slider-reviews"),c=a.getAttribute("data-key"),d=a.getAttribute("data-id"),e=a.getAttribute("data-sku");fetchProductReviews(e,c,d,c=>{trustWidget(a,c.starsAverage,c.starsAverage,c.numberOfReviews.total),Array.isArray(c.productReviews)&&c.productReviews.forEach(a=>{b.innerHTML+=renderProductSliderReview(a)}),hideLoading(a,".trustpilot-product-slider"),mouseScrollX(".trustpilot-slider-reviews")})}// Initializes all existing widgets on the page just after it finishes loading.
window.onload=()=>{const a=document.querySelectorAll(".trustpilot-wrapper");a&&Array.from(a).forEach(a=>{const b=a.getAttribute("data-template"),c=a.getAttribute("data-sku");switch(b){case"product":productWidget(a);break;case"product-summary":productWidget(a,!1);break;case"slider":c?sliderProductWidget(a):sliderBusinessWidget(a);break;case"grid":gridWidget(a);break;case"mini":miniWidget(a);break;case"micro":microWidget(a);break;default:}})};